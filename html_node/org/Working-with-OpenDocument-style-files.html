<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<link rev="made" href="mailto:bug-gnu-emacs@gnu.org">
<link rel="icon" type="image/png" href="/graphics/gnu-head-mini.png">
<meta name="ICBM" content="42.256233,-71.006581">
<meta name="DC.title" content="gnu.org">

<title>Working with OpenDocument style files - The Org Manual</title>
<!--
This manual is for Org version 9.1.9.

Copyright (C) 2004--2019 Free Software Foundation, Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections, with the Front-Cover Texts
     being ``A GNU Manual,'' and with the Back-Cover Texts as in (a)
     below.  A copy of the license is included in the section entitled
     ``GNU Free Documentation License.''

     (a) The FSF's Back-Cover Text is: ``You have the freedom to copy
     and modify this GNU manual.''
   -->
<style type="text/css">
@import url('/software/emacs/manual.css');
</style>
</head>
<body>
<div class="node" style="background-color:#DDDDFF">
<a name="Working-with-OpenDocument-style-files"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Creating-one_002doff-styles.html#Creating-one_002doff-styles">Creating one-off styles</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Configuring-a-document-converter.html#Configuring-a-document-converter">Configuring a document converter</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Advanced-topics-in-ODT-export.html#Advanced-topics-in-ODT-export">Advanced topics in ODT export</a>

</div>

<h5 class="subsubheading">Working with OpenDocument style files</h5>

<p><a name="index-styles_002c-custom-1942"></a><a name="index-template_002c-custom-1943"></a>
This section explores the internals of the ODT exporter; the means by which
it produces styled documents; the use of automatic and custom OpenDocument
styles.

   <p><a name="x_002dfactory_002dstyles"></a>

<h5 class="subsubheading">a) Factory styles</h5>

<p>The ODT exporter relies on two files for generating its output. 
These files are bundled with the distribution under the directory pointed to
by the variable <code>org-odt-styles-dir</code>.  The two files are:

     <ul>
<a name="x_002dorgodtstyles_002dxml"></a><li><samp><span class="file">OrgOdtStyles.xml</span></samp>

     <p>This file contributes to the <samp><span class="file">styles.xml</span></samp> file of the final &lsquo;<samp><span class="samp">ODT</span></samp>&rsquo;
document.  This file gets modified for the following purposes:
          <ol type=1 start=1>

          <li>To control outline numbering based on user settings.

          <li>To add styles generated by <samp><span class="file">htmlfontify.el</span></samp> for fontification of code
blocks.
          </ol>

     <p><a name="x_002dorgodtcontenttemplate_002dxml"></a><li><samp><span class="file">OrgOdtContentTemplate.xml</span></samp>

     <p>This file contributes to the <samp><span class="file">content.xml</span></samp> file of the final &lsquo;<samp><span class="samp">ODT</span></samp>&rsquo;
document.  The contents of the Org outline are inserted between the
&lsquo;<samp><span class="samp">&lt;office:text&gt;</span></samp>&rsquo;<small class="dots">...</small>&lsquo;<samp><span class="samp">&lt;/office:text&gt;</span></samp>&rsquo; elements of this file.

     <p>Apart from serving as a template file for the final <samp><span class="file">content.xml</span></samp>, the
file serves the following purposes:
          <ol type=1 start=1>

          <li>It contains automatic styles for formatting of tables which are referenced by
the exporter.

          <li>It contains &lsquo;<samp><span class="samp">&lt;text:sequence-decl&gt;</span></samp>&rsquo;<small class="dots">...</small>&lsquo;<samp><span class="samp">&lt;/text:sequence-decl&gt;</span></samp>&rsquo;
elements that control numbering of tables, images, equations, and similar
entities.
          </ol>
</ul>

   <p><a name="x_002doverriding_002dfactory_002dstyles"></a>

<h5 class="subsubheading">b) Overriding factory styles</h5>

<p>The following two variables control the location from where the ODT exporter
picks up the custom styles and content template files.  Customize these
variables to override the factory styles used by the exporter.

     <ul>
<a name="x_002dorg_002dodt_002dstyles_002dfile"></a><li><code>org-odt-styles-file</code>

     <p>The ODT export back-end uses the file pointed to by this variable, such as
<samp><span class="file">styles.xml</span></samp>, for the final output.  It can take one of the following
values:

          <ol type=1 start=1>
<li>A <samp><span class="file">styles.xml</span></samp> file

          <p>Use this file instead of the default <samp><span class="file">styles.xml</span></samp>

          <li>A <samp><span class="file">.odt</span></samp> or <samp><span class="file">.ott</span></samp> file

          <p>Use the <samp><span class="file">styles.xml</span></samp> contained in the specified OpenDocument Text or
Template file

          <li>A <samp><span class="file">.odt</span></samp> or <samp><span class="file">.ott</span></samp> file and a subset of files contained within them

          <p>Use the <samp><span class="file">styles.xml</span></samp> contained in the specified OpenDocument Text or
Template file.  Additionally extract the specified member files and embed
those within the final &lsquo;<samp><span class="samp">ODT</span></samp>&rsquo; document.

          <p>Use this option if the <samp><span class="file">styles.xml</span></samp> file references additional files
like header and footer images.

          <li><code>nil</code>

          <p>Use the default <samp><span class="file">styles.xml</span></samp>
          </ol>

     <p><a name="x_002dorg_002dodt_002dcontent_002dtemplate_002dfile"></a><li><code>org-odt-content-template-file</code>

     <p>Use this variable to specify the blank <samp><span class="file">content.xml</span></samp> that will be used
in the final output. 
</ul>

   </body></html>

