<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<link rev="made" href="mailto:bug-gnu-emacs@gnu.org">
<link rel="icon" type="image/png" href="/graphics/gnu-head-mini.png">
<meta name="ICBM" content="42.256233,-71.006581">
<meta name="DC.title" content="gnu.org">

<title>Loop Basics - Common Lisp Extensions</title>
<!--
This file documents the GNU Emacs Common Lisp emulation package.

Copyright (C) 1993, 2001--2019 Free Software Foundation, Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections, with the Front-Cover Texts
     being ``A GNU Manual'', and with the Back-Cover Texts as in (a)
     below.  A copy of the license is included in the section entitled
     ``GNU Free Documentation License''.

     (a) The FSF's Back-Cover Text is: ``You have the freedom to copy
     and modify this GNU manual.''
   -->
<style type="text/css">
@import url('/software/emacs/manual.css');
</style>
</head>
<body>
<div class="node" style="background-color:#DDDDFF">
<a name="Loop-Basics"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Loop-Examples.html#Loop-Examples">Loop Examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Loop-Facility.html#Loop-Facility">Loop Facility</a>

</div>

<h4 class="subsection">4.7.1 Loop Basics</h4>

<p class="noindent">The <code>cl-loop</code> macro essentially creates a mini-language within
Lisp that is specially tailored for describing loops.  While this
language is a little strange-looking by the standards of regular Lisp,
it turns out to be very easy to learn and well-suited to its purpose.

   <p>Since <code>cl-loop</code> is a macro, all parsing of the loop language
takes place at byte-compile time; compiled <code>cl-loop</code>s are just
as efficient as the equivalent <code>while</code> loops written longhand.

<div class="defun">
&mdash; Macro: <b>cl-loop</b><var> clauses<small class="dots">...</small><a name="index-cl_002dloop-57"></a></var><br>
<blockquote><p>A loop construct consists of a series of <var>clause</var>s, each
introduced by a symbol like <code>for</code> or <code>do</code>.  Clauses
are simply strung together in the argument list of <code>cl-loop</code>,
with minimal extra parentheses.  The various types of clauses
specify initializations, such as the binding of temporary
variables, actions to be taken in the loop, stepping actions,
and final cleanup.

        <p>Common Lisp specifies a certain general order of clauses in a
loop:

     <pre class="example">          (loop <var>name-clause</var>
                <var>var-clauses</var>...
                <var>action-clauses</var>...)
</pre>
        <p>The <var>name-clause</var> optionally gives a name to the implicit
block that surrounds the loop.  By default, the implicit block
is named <code>nil</code>.  The <var>var-clauses</var> specify what
variables should be bound during the loop, and how they should
be modified or iterated throughout the course of the loop.  The
<var>action-clauses</var> are things to be done during the loop, such
as computing, collecting, and returning values.

        <p>The Emacs version of the <code>cl-loop</code> macro is less restrictive about
the order of clauses, but things will behave most predictably if
you put the variable-binding clauses <code>with</code>, <code>for</code>, and
<code>repeat</code> before the action clauses.  As in Common Lisp,
<code>initially</code> and <code>finally</code> clauses can go anywhere.

        <p>Loops generally return <code>nil</code> by default, but you can cause
them to return a value by using an accumulation clause like
<code>collect</code>, an end-test clause like <code>always</code>, or an
explicit <code>return</code> clause to jump out of the implicit block. 
(Because the loop body is enclosed in an implicit block, you can
also use regular Lisp <code>cl-return</code> or <code>cl-return-from</code> to
break out of the loop.) 
</p></blockquote></div>

   <p>The following sections give some examples of the loop macro in
action, and describe the particular loop clauses in great detail. 
Consult the second edition of Steele for additional discussion
and examples.

   </body></html>

